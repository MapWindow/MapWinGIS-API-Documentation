<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="MapWinGIS.ocx is used to provide GIS and mapping functionality to any Windows Forms based custom software application."/>
<meta name="keywords" content="MapWinGIS, v5.4, 'open source', free, gis, map, mapping, documentation"/>
<meta name="author" content="MapWindow GIS Community">
<title>MapWinGIS: Getting started with MapWinGIS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mapwingis.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="header-logos">
	<div id="project-logo">
		<img alt="Logo" src="mapwingis_logo5-100px.png" />
	</div>
	<div id="sponsors">
	    <a href="https://www.topx-group.nl/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="TopX Geo-ICT provides man power">
	      <img src="topx.jpg" alt=""/></a>
		<a href="https://www.jetbrains.com/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="ReSharper is a great tool to optimize our code">
	      <img src="jetbrains.png" alt=""/></a>
		<a id="syncfusion" href="https://www.syncfusion.com/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="The Syncfusion components are widely used in MapWindow5">
	      <img src="syncfusion.png" alt=""/></a>	  
	</div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('getting_started.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Getting started with MapWinGIS </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Let's start assuming that you:</p><ul>
<li>Installed the latest 32-Bit version of MapWinGIS using the installer available on the <a href="https://github.com/MapWindow/MapWinGIS/releases">MapWinGIS GitHub site</a>;</li>
<li>Created a new WinForms project in Visual Studio and have a new Form to add Map control to.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>You can create a 64-Bit version of you application and run it with the 64-Bit version of MapWinGIS, but you need to install the 32-Bit version of MapWinGIS as well to be able to use the control in Visual Studio. This is because Visual Studio cannot handle 64-Bit ActiveX controls.</dd></dl>
<h1><a class="anchor" id="gs1"></a>
A. Adding control control to .NET WinForms project.</h1>
<p >Here are steps to start working with MapWinGIS ActiveX control:<br  />
<br  />
</p><ol type="1">
<li>Right click on Toolbox window (Ctrl + Alt + X) and select "Choose items" option.<br  />
<br  />
</li>
<li>Choose "COM Components" Tab and check MapWinGIS "Map control" item in the list.<br  />
<div class="left"> <div class="image">
<img src="toolbox_add.jpg" alt=""/>
</div>
 </div> It will appear in the toolbox: <div class="left"> <div class="image">
<img src="toolbox_add2.jpg" alt=""/>
</div>
 </div></li>
<li>Drag the control from Toolbox on design surface of the form.<br  />
<div class="left"> <div class="image">
<img src="form_add.jpg" alt=""/>
</div>
 </div></li>
<li>Set the following properties for the control in Properties window (F4):<br  />
<div class="fragment"><div class="line"><a class="code hl_class" href="class_ax_map.html">AxMap</a>.<a class="code hl_property" href="group__map__coordinates.html#gab92dae994a0c57d34d393933db142827">Projection</a> = <a class="code hl_enumeration" href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a>.PROJECTION_GOOGLE_MERCATOR;</div>
<div class="line"><a class="code hl_class" href="class_ax_map.html">AxMap</a>.<a class="code hl_property" href="class_ax_map.html#a5a038b77550b5f653818967a626981e6">TileProvider</a> = <a class="code hl_enumeration" href="_enumerations_8cs.html#a067bd33fa956ac809260fea04b52dc96">tkTileProvider</a>.OpenStreetMap;</div>
<div class="line"><a class="code hl_class" href="class_ax_map.html">AxMap</a>.<a class="code hl_property" href="group__map__extents.html#ga807a083df8aa9a4b3cb5119bcf008f3b">KnownExtents</a> = <a class="code hl_enumeration" href="_known_01extents_8cs.html#a3f4d5ea0773503afde5c48a24b1068fe">tkKnownExtents</a>.keUSA;</div>
<div class="ttc" id="a_enumerations_8cs_html_a067bd33fa956ac809260fea04b52dc96"><div class="ttname"><a href="_enumerations_8cs.html#a067bd33fa956ac809260fea04b52dc96">tkTileProvider</a></div><div class="ttdeci">tkTileProvider</div><div class="ttdoc">Tile providers enumeration</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:2837</div></div>
<div class="ttc" id="a_enumerations_8cs_html_ad7975e2723bbf83d20e1820bb0020dd7"><div class="ttname"><a href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a></div><div class="ttdeci">tkMapProjection</div><div class="ttdoc">Commonly used map projections to be set in Form Designer (see AxMap.Projection property).</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:1741</div></div>
<div class="ttc" id="a_known_01extents_8cs_html_a3f4d5ea0773503afde5c48a24b1068fe"><div class="ttname"><a href="_known_01extents_8cs.html#a3f4d5ea0773503afde5c48a24b1068fe">tkKnownExtents</a></div><div class="ttdeci">tkKnownExtents</div><div class="ttdoc">List of known extents (mostly countries of the world)</div><div class="ttdef"><b>Definition:</b> Known extents.cs:7</div></div>
<div class="ttc" id="aclass_ax_map_html"><div class="ttname"><a href="class_ax_map.html">AxMap</a></div><div class="ttdoc">Map component for visualization of vector, raster or grid data.</div><div class="ttdef"><b>Definition:</b> AxMap.cs:56</div></div>
<div class="ttc" id="aclass_ax_map_html_a5a038b77550b5f653818967a626981e6"><div class="ttname"><a href="class_ax_map.html#a5a038b77550b5f653818967a626981e6">AxMap.TileProvider</a></div><div class="ttdeci">tkTileProvider TileProvider</div><div class="ttdoc">Gets or sets tile provider for the map.</div><div class="ttdef"><b>Definition:</b> AxMap.cs:323</div></div>
<div class="ttc" id="agroup__map__coordinates_html_gab92dae994a0c57d34d393933db142827"><div class="ttname"><a href="group__map__coordinates.html#gab92dae994a0c57d34d393933db142827">AxMap.Projection</a></div><div class="ttdeci">tkMapProjection Projection</div><div class="ttdoc">Sets projection of the map. It providers 2 most commonly used coordinate system/projections to be eas...</div><div class="ttdef"><b>Definition:</b> AxMap.cs:2709</div></div>
<div class="ttc" id="agroup__map__extents_html_ga807a083df8aa9a4b3cb5119bcf008f3b"><div class="ttname"><a href="group__map__extents.html#ga807a083df8aa9a4b3cb5119bcf008f3b">AxMap.KnownExtents</a></div><div class="ttdeci">tkKnownExtents KnownExtents</div><div class="ttdoc">Gets or sets known extents for the map.</div><div class="ttdef"><b>Definition:</b> AxMap.cs:2384</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The screenshots actually show BingMaps provider, but in version 4.9.3 it requires an API key to be specified first, therefore we changed instructions to OpenStreetMap which is available out of the box.</dd></dl>
Map control should redraw itself according to these settings. <div class="left"> <div class="image">
<img src="form_add2.jpg" alt=""/>
</div>
 </div></li>
<li>Run the project to make sure that it works at runtime.<br  />
 To change the area of map being displayed the following properties can be used: <a class="el" href="group__map__extents.html#gafeabca0efb305f60278c52b48c2c7d2f" title="Gets or sets latitude of the center of screen (in decimal degrees).">AxMap.Latitude</a>, <a class="el" href="group__map__extents.html#gab5248dbf5a7ac88d7a1aa7d31b3dc222" title="Gets or sets longitude of the center of screen (in decimal degrees).">AxMap.Longitude</a>, <a class="el" href="group__map__extents.html#gadacfa53df7be44c00eda2ef68f968556" title="Gets or sets the current zoom level for the map. It corresponds to the zoom level of current tile pro...">AxMap.CurrentZoom</a>. For example, to display Paris, let set them to: Latitude = 48.85; Longitude = 2.36; CurrentZoom = 12.</li>
</ol>
<div class="left"> <div class="image">
<img src="form_add3.jpg" alt=""/>
</div>
 </div><ol type="1">
<li>If you access Internet via proxy it may also be needed to configure proxy settings for MapWinGIS.<br  />
</li>
</ol>
<p >Start with calling: </p><div class="fragment"><div class="line"><span class="comment">// it will try to copy settings from IE</span></div>
<div class="line">axMap1.Tiles.AutoDetectProxy();</div>
</div><!-- fragment --><p> If that doesn't help, try to set it explicitly: </p><div class="fragment"><div class="line">axMap1.Tiles.SetProxy(<span class="stringliteral">&quot;ip_address_of_proxy&quot;</span>, port);</div>
</div><!-- fragment --><p> Finally if tiles are still not shown the issue can be debugged with Fiddler. To allow Fiddler intercept HTTP requests set the following proxy settings: </p><div class="fragment"><div class="line">axMap1.Tiles.SetProxy(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 8888);</div>
</div><!-- fragment --><ol type="1">
<li>Additional information displayed on the map can be configured using:</li>
</ol>
<ul>
<li><a class="el" href="group__map__coordinates.html#gace32eb18318f625f224a2eb67dac41ad" title="Gets or sets a value which indicate whether scalebar will be displayed on the map.">AxMap.ScalebarVisible</a>, <a class="el" href="group__map__coordinates.html#ga65a190117ae5677d830f9c6eef0664fc" title="Gets or sets units to be displayed for map scalebar.">AxMap.ScalebarUnits</a> - scalebar in lower left corner;</li>
<li><a class="el" href="group__map__coordinates.html#ga855c0247507089c532eb13f5b13b0c1d" title="Gets or sets a value indicating whether coordinates of the current mouse position will be displayed o...">AxMap.ShowCoordinates</a> - coordinates of mouse cursor position in top left corder;</li>
<li><a class="el" href="class_ax_map.html#ad22a797bddc0427058713cc70ba33891" title="Gets or sets a boolean value which indicate whether control&#39;s version number will be displayed on the...">AxMap.ShowVersionNumber</a> - version number of control in bottom right corner;</li>
<li><a class="el" href="class_ax_map.html#aff050770adeb67a43267518139701e8f" title="Gets or sets a value which indicates whether the time of map redraw will be displayed on the screen.">AxMap.ShowRedrawTime</a> - redraw time in top right corner.</li>
</ul>
<h1><a class="anchor" id="gs3"></a>
B. Adding documentation to Visual Studio IntelliSense.</h1>
<p >Let's add a button, double-click on it and start typing some code. We shall see VS IntelliSense autocomplete menu, however there won't be any description of members. </p><div class="left"> <div class="image">
<img src="intellisense.jpg" alt=""/>
</div>
 </div><p> To fix this use the following steps:<br  />
<br  />
</p><ol type="1">
<li>Open folder with MapWinGIS installation (by default c:\dev\MapWinGIS) and copy Interop.MapWinGIS.xml and AxInterop.MapWinGIS.xml files in obj\Debug folder in your project. The names of Interop assemblies which should already be there must match the names of the files: Interop.MapWinGIS.dll and AxInterop.MapWinGIS.dll.<br  />
<br  />
</li>
<li>Reload your WinForms project to make sure the new files are found.<br  />
<br  />
Let's try to type the same line once more. Description of API members must be present this time.<br  />
<div class="left"> <div class="image">
<img src="intellisense2.jpg" alt=""/>
</div>
 </div> The latest versions of XML documentation for Interop assemblies can also be found in the repository: <a href="https://github.com/MapWindow/MapWinGIS/blob/master/docs/Interop.MapWinGIS.XML">Interop.MapWinGIS.xml</a> <a href="https://github.com/MapWindow/MapWinGIS/blob/master/docs/AxInterop.MapWinGIS.XML">AxInterop.MapWinGIS.xml</a></li>
</ol>
<h1><a class="anchor" id="gs4"></a>
C. Default hotkeys.</h1>
<p >Map control uses the following built-in keyboard hotkeys:</p><ul>
<li>"+" - zoom in;</li>
<li>"-" - zoom out;</li>
<li>"*" - zoom to the closest tile level;</li>
<li>"Home" - zoom to combined extents of all data layers (max extents);</li>
<li>"Backspace" - zoom to previous extents;</li>
<li>"Shift + Left", "Shift + Right" - zoom to the prev/ next layer;</li>
<li>"Z" - ZoomIn tool;</li>
<li>"M" - measuring tool;</li>
<li>"Space" - switches to panning mode; after releasing shift the previous map cursor is restored;</li>
<li>arrow keys - to move the map;</li>
<li>mouse wheel - to zoom in/out regardless of the current tool.</li>
</ul>
<p >Hot keys will work if map is focused. It's enough to click the map with mouse to set input focus to it.</p>
<p >Arrow keys won't be passed automatically to <a class="el" href="class_ax_map.html" title="Map component for visualization of vector, raster or grid data.">AxMap</a> control. To enable them the following code should be placed in constructor of Form: </p><div class="fragment"><div class="line">this.axMap1.PreviewKeyDown += delegate(<span class="keywordtype">object</span> sender, PreviewKeyDownEventArgs e)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (e.KeyCode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> Keys.Left:</div>
<div class="line">        <span class="keywordflow">case</span> Keys.Right:</div>
<div class="line">        <span class="keywordflow">case</span> Keys.Up:</div>
<div class="line">        <span class="keywordflow">case</span> Keys.Down:</div>
<div class="line">            e.IsInputKey = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="gs5"></a>
D. Measuring tool.</h1>
<p >MapWinGIS has built-in measuring tool. To start measuring set in Properties window or in code: </p><div class="fragment"><div class="line">axMap1.CursorMode = <a class="code hl_enumvalue" href="_enumerations_8cs.html#a988ad29d268eb5a035739d90080581d3a0224b63196f1babcc34c62084524151e">cmMeasure</a>;</div>
<div class="ttc" id="a_enumerations_8cs_html_a988ad29d268eb5a035739d90080581d3a0224b63196f1babcc34c62084524151e"><div class="ttname"><a href="_enumerations_8cs.html#a988ad29d268eb5a035739d90080581d3a0224b63196f1babcc34c62084524151e">tkCursorMode.cmMeasure</a></div><div class="ttdeci">@ cmMeasure</div><div class="ttdoc">Measuring of area or distance will take place. See Measuring class for details.</div></div>
</div><!-- fragment --><p> Or use M hotkey when map is focused. Mouse cursor will have a ruler at its bottom. To toggle to area measuring mode use: </p><div class="fragment"><div class="line">axMap1.Measuring.MeasuringType= <a class="code hl_enumeration" href="_enumerations_8cs.html#a97c3bed3d43263ed565a21c9647a95e0">tkMeasuringType</a>.MeasureArea;</div>
<div class="ttc" id="a_enumerations_8cs_html_a97c3bed3d43263ed565a21c9647a95e0"><div class="ttname"><a href="_enumerations_8cs.html#a97c3bed3d43263ed565a21c9647a95e0">tkMeasuringType</a></div><div class="ttdeci">tkMeasuringType</div><div class="ttdoc">Possible measuring types.</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:1594</div></div>
</div><!-- fragment --><p> Here are screenshots for both modes of measuring:<br  />
</p><div align="left"> <table cellspacing="0" cellpadding="0, 10" style="border: none; width: 900px;">
<tr align="center">
<td width="33%"><div class="image">
<img src="measure_distance.jpg" alt=""/>
</div>
 </td><td width="33%"><div class="image">
<img src="measure_area.jpg" alt=""/>
</div>
  </td></tr>
<tr>
<td align="center">Measuring distance </td><td align="center">Measuring area  </td></tr>
</table>
</div><p >The following mouse hotkeys are supported:</p><ul>
<li>Left-click: add new points;</li>
<li>Right-click: undo the last point;</li>
<li>Double-click: finish measuring of the current path; the next left click after it will start a new path;</li>
<li>Ctrl-click on one of the preceding vertices in distance mode, to close polygon and measure its area;</li>
<li>Shift-click to snap to the closest vertex of shapefile.</li>
</ul>
<p >To clear measured path set different cursor to <a class="el" href="group__map__interaction.html#ga384351bf3467a7ddb389415141add823" title="Gets or sets the cursor mode for the map.">AxMap.CursorMode</a> property (Z shortcut can be used to switch to cmZoomIn tool).</p>
<h1><a class="anchor" id="gs6"></a>
E. Displaying data layers.</h1>
<p >Data layers can be opened with or without explicit creation of corresponding COM object.<br  />
<br  />
</p><ol type="1">
<li>Without explicit creation of COM object: <div class="fragment"><div class="line"><span class="keywordtype">string</span> filename = <span class="stringliteral">&quot;z:\\some_filename.shp&quot;</span></div>
<div class="line"><span class="keywordtype">int</span> layerHandle = axMap1.AddLayerFromFilename(filename, <a class="code hl_enumeration" href="_enumerations_8cs.html#aafd2a02b2f6575609a8eddccb37d0aaa">tkFileOpenStrategy</a>.fosAutoDetect, <span class="keyword">true</span>);</div>
<div class="line"><span class="keywordflow">if</span> (layerHandle == -1) {</div>
<div class="line">    Debug.WriteLine(<span class="stringliteral">&quot;Failed to open datasource: &quot;</span> + axMap1.FileManager.get_ErrorMsg(axMap1.FileManager.LastErrorCode);</div>
<div class="line">}</div>
<div class="ttc" id="a_enumerations_8cs_html_aafd2a02b2f6575609a8eddccb37d0aaa"><div class="ttname"><a href="_enumerations_8cs.html#aafd2a02b2f6575609a8eddccb37d0aaa">tkFileOpenStrategy</a></div><div class="ttdeci">tkFileOpenStrategy</div><div class="ttdoc">Possible open strategies for datasources.</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:1799</div></div>
</div><!-- fragment --></li>
<li>With explicit creation of COM object:<br  />
<br  />
For shapefiles: <div class="fragment"><div class="line">var sf = <span class="keyword">new</span> <a class="code hl_class" href="class_shapefile.html">Shapefile</a>();</div>
<div class="line"><span class="keywordflow">if</span> (sf.Open(filename, <span class="keyword">null</span>)) {</div>
<div class="line">    <span class="keywordtype">int</span> layerHandle = axMap1.AddLayer(sf, <span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> {</div>
<div class="line">    Debug.WriteLine(<span class="stringliteral">&quot;Failed to open shapefile: &quot;</span> + sf.get_ErrorMsg(sf.LastErrorCode));</div>
<div class="line">}</div>
<div class="ttc" id="aclass_shapefile_html"><div class="ttname"><a href="class_shapefile.html">Shapefile</a></div><div class="ttdoc">Provides a functionality for accessing and editing ESRI shapefiles.</div><div class="ttdef"><b>Definition:</b> Shapefile.cs:72</div></div>
</div><!-- fragment --> For RGB images <div class="fragment"><div class="line">var img = <span class="keyword">new</span> <a class="code hl_class" href="class_image.html">Image</a>();</div>
<div class="line"><span class="keywordflow">if</span> (img.Open(filename, <span class="keyword">null</span>)) {</div>
<div class="line">    <span class="keywordtype">int</span> layerHandle = axMap1.AddLayer(img, <span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> {</div>
<div class="line">    Debug.WriteLine(<span class="stringliteral">&quot;Failed to open image: &quot;</span> + img.get_ErrorMsg(img.LastErrorCode));</div>
<div class="line">}</div>
<div class="ttc" id="aclass_image_html"><div class="ttname"><a href="class_image.html">Image</a></div><div class="ttdoc">Represents an raster image of particular format which may be added to the map.</div><div class="ttdef"><b>Definition:</b> Image.cs:66</div></div>
</div><!-- fragment --></li>
</ol>
<p >Opening of grid datasources with explicit creation of COM object is somewhat more involved topic. See details in overview of <a class="el" href="class_grid.html" title="The grid object is used to represent a grid which can be added to the map.">Grid</a> class.<br  />
 It may also be needed to call: </p><div class="fragment"><div class="line">axMap1.ZoomToLayer(layerHandle);</div>
</div><!-- fragment --><h1><a class="anchor" id="gs7"></a>
F. Projection mismatch testing.</h1>
<p >Adding of layer to the map may fail because of projection mismatch testing (<a class="el" href="class_global_settings.html#ac50b27d2854f7f95e9468b60c1af5170" title="Gets or sets a value indicating whether layers with coordinate system / projection different from tho...">GlobalSettings.AllowProjectionMismatch</a>). It's turned off by default (i.e. set to true; mismatch is allowed), so any layer will be added to the map even if its projection doesn't match. <br  />
 If projection mismatch testing is on and reprojection option is chosen (<a class="el" href="class_global_settings.html#a3b13db883be4cef7fd2f04fc0e7ccf7f" title="Gets or sets a value which determines whether automatic on-the-fly reprojection of the vector layer w...">GlobalSettings.ReprojectLayersOnAdding</a>), a copy of datasource may be created in <a class="el" href="group__map__layer__management.html#ga4ac38e033e7e288dd23850d05a25e0a1" title="Adds a layer to the map.">AxMap.AddLayer</a>. Any initialization logic in this case should be run after layer was added to the map. </p><div class="fragment"><div class="line"><span class="keyword">new</span> <a class="code hl_class" href="class_global_settings.html">GlobalSettings</a>() { AllowProjectionMismatch = <span class="keyword">false</span>, ReprojectLayersOnAdding = <span class="keyword">true</span> };</div>
<div class="line">var sf = <span class="keyword">new</span> <a class="code hl_class" href="class_shapefile.html">Shapefile</a>();</div>
<div class="line"><span class="keywordflow">if</span> (sf.Open(filename, <span class="keyword">null</span>)) </div>
<div class="line">{</div>
<div class="line">    <span class="comment">//sf.GenerateLabels(0, tkLabelPositioning.lpCentroid); // don&#39;t call it here as labels may be lost</span></div>
<div class="line">    <span class="keywordtype">int</span> layerHandle = axMap1.AddLayer(sf, <span class="keyword">true</span>);</div>
<div class="line">    sf = axMap1.get_Shapefile(layerHandle);                <span class="comment">// grab the reprojected version of shapefile</span></div>
<div class="line">    sf.GenerateLabels(0, <a class="code hl_enumeration" href="_enumerations_8cs.html#a3f5b957c512f0248ffa315a1b7885904">tkLabelPositioning</a>.lpCentroid);   <span class="comment">// now it&#39;s ok to generate labels</span></div>
<div class="line">}</div>
<div class="ttc" id="a_enumerations_8cs_html_a3f5b957c512f0248ffa315a1b7885904"><div class="ttname"><a href="_enumerations_8cs.html#a3f5b957c512f0248ffa315a1b7885904">tkLabelPositioning</a></div><div class="ttdeci">tkLabelPositioning</div><div class="ttdoc">The available positioning of the label relative to the parent shape.</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:835</div></div>
<div class="ttc" id="aclass_global_settings_html"><div class="ttname"><a href="class_global_settings.html">GlobalSettings</a></div><div class="ttdoc">Holds global settings for MapWinGIS. Allows to retrieve GDAL errors.</div><div class="ttdef"><b>Definition:</b> GlobalSettings.cs:29</div></div>
</div><!-- fragment --><p> The previous point is relevant only if projection of datasource is different from projection of map. In most cases there is no difference whether to do initialization before or after adding it to the map. To make sure that map uses the same projection as the one set for datasource use: </p><div class="fragment"><div class="line">axMap1.Projection = <a class="code hl_enumeration" href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a>.PROJECTION_NONE;</div>
<div class="line">axMap1.GrabProjectionFromData = <span class="keyword">true</span>;</div>
<div class="line">axMap1.AddLayerFromFilename(filename, <a class="code hl_enumeration" href="_enumerations_8cs.html#aafd2a02b2f6575609a8eddccb37d0aaa">tkFileOpenStrategy</a>.fosAutoDetect, <span class="keyword">true</span>);</div>
</div><!-- fragment --><p> Built-in reprojection is currently supported for shapefile layers only.</p>
<h1><a class="anchor" id="gs8"></a>
G. Updating the previous versions of MapWinGIS.</h1>
<p >To update your application to a new version of MapWinGIS the following steps will be needed:<br  />
<br  />
1) Install the new version of MapWinGIS from installer or register it manually with regsvr32 utility (all dependent libraries must be present in the latter case);<br  />
2) Create a new WinForms project in Visual Studio, select necessary version of .NET Framework, add MapWinGIS control to the form.<br  />
3) Copy automatically created interop assemblies (Interop.MapWinGIS.dll, AxInterop.MapWinGIS.dll) from new_winforms_project\obj\debug to your_old_winforms_project\obj\debug.<br  />
4) Rebuild project. Over a course of time there were a few small changes in API (like Shape.numPoints -&gt; <a class="el" href="class_shape.html#af8fec12ef3300b63bca7dd9dea9da073" title="Gets the number of points contained in the shape.">Shape.NumPoints</a>), so perhaps a couple of batch renamings will be needed.<br  />
5) It's also recommended to comment the following line in Form Designer: </p><div class="fragment"><div class="line">this.axMap1.OcxState = ((System.Windows.Forms.AxHost.State)(resources.GetObject(<span class="stringliteral">&quot;axMap1.OcxState&quot;</span>)));</div>
</div><!-- fragment --><p> This will reset control's properties set in the designer, as outdated state information often becomes a source of problems. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 21 2022 15:44:06 for MapWinGIS by 
		<a href="https://www.doxygen.org/index.html">
			<img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/>
		</a> 1.9.3 
	</li>
  </ul>
</div>
<footer>
<!-- ---------------------------------------------------------------------------- 
 Place the following near the bottom of the body of the html content to load the 
 script and execute the ad load method. 
 Only place ONE copy at the bottom of the file, NOT one for each tag.  The script 
 finds all the tags and then make the requests to the Ad Server for each of them.
-----------------------------------------------------------------------------  -->
<script type='text/javascript'>
    function _dmBootstrap(file) { 
        var _dma = document.createElement('script');  
        _dma.type = 'text/javascript'; 
        _dma.async = true;  
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file; 
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined')  _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000);})();
</script> 
</footer>
</body>
</html>
