<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="MapWinGIS.ocx is used to provide GIS and mapping functionality to any Windows Forms based custom software application."/>
<meta name="keywords" content="MapWinGIS, v5.4, 'open source', free, gis, map, mapping, documentation"/>
<meta name="author" content="MapWindow GIS Community">
<title>MapWinGIS: OgrDatasource Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mapwingis.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="header-logos">
	<div id="project-logo">
		<img alt="Logo" src="mapwingis_logo5-100px.png" />
	</div>
	<div id="sponsors">
	    <a href="https://www.topx-group.nl/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="TopX Geo-ICT provides man power">
	      <img src="topx.jpg" alt=""/></a>
		<a href="https://www.jetbrains.com/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="ReSharper is a great tool to optimize our code">
	      <img src="jetbrains.png" alt=""/></a>
		<a id="syncfusion" href="https://www.syncfusion.com/?utm_source=MapWindow&utm_medium=cpc" target="_blank" title="The Syncfusion components are widely used in MapWindow5">
	      <img src="syncfusion.png" alt=""/></a>	  
	</div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_ogr_datasource.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="class_ogr_datasource-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">OgrDatasource Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Represents GDAL/OGR vector datasource which may be represented by spatial database or file-based vector format.  
 <a href="class_ogr_datasource.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for OgrDatasource:</div>
<div class="dyncontent">
<div class="center"><img src="class_ogr_datasource__coll__graph.png" border="0" usemap="#a_ogr_datasource_coll__map" alt="Collaboration graph"/></div>
<map name="a_ogr_datasource_coll__map" id="a_ogr_datasource_coll__map">
<area shape="rect" title="Represents GDAL/OGR vector datasource which may be represented by spatial database or file&#45;based vect..." alt="" coords="5,5,185,317"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3e68dc609f730e39277b6b88b47f4a35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a3e68dc609f730e39277b6b88b47f4a35">Close</a> ()</td></tr>
<tr class="memdesc:a3e68dc609f730e39277b6b88b47f4a35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes datasource and underlying connection.  <a href="class_ogr_datasource.html#a3e68dc609f730e39277b6b88b47f4a35">More...</a><br /></td></tr>
<tr class="separator:a3e68dc609f730e39277b6b88b47f4a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7bba28541e83f353dbadb932c45fd7f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ab7bba28541e83f353dbadb932c45fd7f">CreateLayer</a> (string layerName, <a class="el" href="_enumerations_8cs.html#a96d6460f5cd3c49b4c12be5a38c82b4e">ShpfileType</a> ShpType, <a class="el" href="class_geo_projection.html">GeoProjection</a> Projection=null, string creationOptions=&quot;&quot;)</td></tr>
<tr class="memdesc:ab7bba28541e83f353dbadb932c45fd7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new empty layer in the datasource.  <a href="class_ogr_datasource.html#ab7bba28541e83f353dbadb932c45fd7f">More...</a><br /></td></tr>
<tr class="separator:ab7bba28541e83f353dbadb932c45fd7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b5c311a096f0631fef35bde93458cb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a83b5c311a096f0631fef35bde93458cb">DeleteLayer</a> (int layerIndex)</td></tr>
<tr class="memdesc:a83b5c311a096f0631fef35bde93458cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a layer with specified index from datasource.  <a href="class_ogr_datasource.html#a83b5c311a096f0631fef35bde93458cb">More...</a><br /></td></tr>
<tr class="separator:a83b5c311a096f0631fef35bde93458cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dbf9de82251c4a2a39cbe00f73c2cb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a5dbf9de82251c4a2a39cbe00f73c2cb9">ExecuteSQL</a> (string sql, out string errorMessage)</td></tr>
<tr class="memdesc:a5dbf9de82251c4a2a39cbe00f73c2cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes SQL statement against datasource.  <a href="class_ogr_datasource.html#a5dbf9de82251c4a2a39cbe00f73c2cb9">More...</a><br /></td></tr>
<tr class="separator:a5dbf9de82251c4a2a39cbe00f73c2cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e221d078d66e3f7333ee25418133ef5"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a0e221d078d66e3f7333ee25418133ef5">get_DriverMetadata</a> (<a class="el" href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694">tkGdalDriverMetadata</a> metadata)</td></tr>
<tr class="memdesc:a0e221d078d66e3f7333ee25418133ef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns certain type of metadata associated with current driver.  <a href="class_ogr_datasource.html#a0e221d078d66e3f7333ee25418133ef5">More...</a><br /></td></tr>
<tr class="separator:a0e221d078d66e3f7333ee25418133ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aba366ca5d8761ec01ea74782ae132c"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a1aba366ca5d8761ec01ea74782ae132c">get_DriverMetadataItem</a> (int metadataIndex)</td></tr>
<tr class="memdesc:a1aba366ca5d8761ec01ea74782ae132c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets metadata item with specified index associated with current driver.  <a href="class_ogr_datasource.html#a1aba366ca5d8761ec01ea74782ae132c">More...</a><br /></td></tr>
<tr class="separator:a1aba366ca5d8761ec01ea74782ae132c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d1066651fd9d05de6a6fdc761a2195"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a73d1066651fd9d05de6a6fdc761a2195">get_ErrorMsg</a> (int ErrorCode)</td></tr>
<tr class="memdesc:a73d1066651fd9d05de6a6fdc761a2195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the description of the specific error code.  <a href="class_ogr_datasource.html#a73d1066651fd9d05de6a6fdc761a2195">More...</a><br /></td></tr>
<tr class="separator:a73d1066651fd9d05de6a6fdc761a2195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7576dfcd2fb8d7d10d14315078a54d91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_ogr_layer.html">OgrLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a7576dfcd2fb8d7d10d14315078a54d91">GetLayer</a> (int Index, bool forUpdate=false)</td></tr>
<tr class="memdesc:a7576dfcd2fb8d7d10d14315078a54d91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a layer with specified index from datasource.  <a href="class_ogr_datasource.html#a7576dfcd2fb8d7d10d14315078a54d91">More...</a><br /></td></tr>
<tr class="separator:a7576dfcd2fb8d7d10d14315078a54d91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f60736d0c98e3f1a042d72eba210993"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_ogr_layer.html">OgrLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a8f60736d0c98e3f1a042d72eba210993">GetLayer2</a> (int Index, bool forUpdate, bool newConnection)</td></tr>
<tr class="separator:a8f60736d0c98e3f1a042d72eba210993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46225206838093c69540668abc28887c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_ogr_layer.html">OgrLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a46225206838093c69540668abc28887c">GetLayerByName</a> (string layerName, bool forUpdate=false)</td></tr>
<tr class="memdesc:a46225206838093c69540668abc28887c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a layer with specified name from the datasource.  <a href="class_ogr_datasource.html#a46225206838093c69540668abc28887c">More...</a><br /></td></tr>
<tr class="separator:a46225206838093c69540668abc28887c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23bcdd5d570729953e616ec77488a73e"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a23bcdd5d570729953e616ec77488a73e">GetLayerName</a> (int layerIndex)</td></tr>
<tr class="memdesc:a23bcdd5d570729953e616ec77488a73e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a name of the layer with particular index.  <a href="class_ogr_datasource.html#a23bcdd5d570729953e616ec77488a73e">More...</a><br /></td></tr>
<tr class="separator:a23bcdd5d570729953e616ec77488a73e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7073ca1e7d63784e3289776fad6a974"><td class="memItemLeft" align="right" valign="top">object&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ae7073ca1e7d63784e3289776fad6a974">GetSchemas</a> ()</td></tr>
<tr class="memdesc:ae7073ca1e7d63784e3289776fad6a974"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the array with schema names in the datasources.  <a href="class_ogr_datasource.html#ae7073ca1e7d63784e3289776fad6a974">More...</a><br /></td></tr>
<tr class="separator:ae7073ca1e7d63784e3289776fad6a974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad426ef7c2279788992fd883442f6b503"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ad426ef7c2279788992fd883442f6b503">ImportShapefile</a> (<a class="el" href="class_shapefile.html">Shapefile</a> shapefile, string layerName, string creationOptions=&quot;&quot;, <a class="el" href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0">tkShapeValidationMode</a> validationMode=<a class="el" href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0a45c5efbe1799d1704a3274f40d6a6ed5">tkShapeValidationMode.TryFixSkipOnFailure</a>)</td></tr>
<tr class="memdesc:ad426ef7c2279788992fd883442f6b503"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new layer in the datasource and populates it with data from specified shapefile.  <a href="class_ogr_datasource.html#ad426ef7c2279788992fd883442f6b503">More...</a><br /></td></tr>
<tr class="separator:ad426ef7c2279788992fd883442f6b503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ada026c12369518aa4616e448e8386"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#af0ada026c12369518aa4616e448e8386">LayerIndexByName</a> (string layerName)</td></tr>
<tr class="memdesc:af0ada026c12369518aa4616e448e8386"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns index of layer with the specified name.  <a href="class_ogr_datasource.html#af0ada026c12369518aa4616e448e8386">More...</a><br /></td></tr>
<tr class="separator:af0ada026c12369518aa4616e448e8386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e2f3a9e4885b0d71978c70583a983d3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a5e2f3a9e4885b0d71978c70583a983d3">Open</a> (string connectionString)</td></tr>
<tr class="memdesc:a5e2f3a9e4885b0d71978c70583a983d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens particular type of datasource supported by GDAL/OGR.  <a href="class_ogr_datasource.html#a5e2f3a9e4885b0d71978c70583a983d3">More...</a><br /></td></tr>
<tr class="separator:a5e2f3a9e4885b0d71978c70583a983d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60fff3aaa784fb1e552bbe0cc36a47c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ab60fff3aaa784fb1e552bbe0cc36a47c">Open2</a> (string connectionString, bool forUpdate)</td></tr>
<tr class="memdesc:ab60fff3aaa784fb1e552bbe0cc36a47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens particular type of datasource supported by GDAL/OGR.  <a href="class_ogr_datasource.html#ab60fff3aaa784fb1e552bbe0cc36a47c">More...</a><br /></td></tr>
<tr class="separator:ab60fff3aaa784fb1e552bbe0cc36a47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035e078df8e7feebe2e23ba1860b8643"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_ogr_layer.html">OgrLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a035e078df8e7feebe2e23ba1860b8643">RunQuery</a> (string sql)</td></tr>
<tr class="memdesc:a035e078df8e7feebe2e23ba1860b8643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs a query against datasource and returns the result as a temporary layer.  <a href="class_ogr_datasource.html#a035e078df8e7feebe2e23ba1860b8643">More...</a><br /></td></tr>
<tr class="separator:a035e078df8e7feebe2e23ba1860b8643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c8e8aa8bdd0541fa476cf90f4d95305"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a3c8e8aa8bdd0541fa476cf90f4d95305">TestCapability</a> (<a class="el" href="_enumerations_8cs.html#a710e0875fd39fa0757cfcbfdacf00052">tkOgrDSCapability</a> capability)</td></tr>
<tr class="memdesc:a3c8e8aa8bdd0541fa476cf90f4d95305"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether driver of the currently opened datasource supports particular capability.  <a href="class_ogr_datasource.html#a3c8e8aa8bdd0541fa476cf90f4d95305">More...</a><br /></td></tr>
<tr class="separator:a3c8e8aa8bdd0541fa476cf90f4d95305"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="properties" name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a6b84377fed7f463443a52f10627da000"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a6b84377fed7f463443a52f10627da000">DriverMetadataCount</a><code> [get]</code></td></tr>
<tr class="memdesc:a6b84377fed7f463443a52f10627da000"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of metadata items associated with current driver.  <a href="class_ogr_datasource.html#a6b84377fed7f463443a52f10627da000">More...</a><br /></td></tr>
<tr class="separator:a6b84377fed7f463443a52f10627da000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d579efdf84696148e2c35ec9b5b37e"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#a41d579efdf84696148e2c35ec9b5b37e">DriverName</a><code> [get]</code></td></tr>
<tr class="memdesc:a41d579efdf84696148e2c35ec9b5b37e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets name driver (name of format) for this datasource.  <a href="class_ogr_datasource.html#a41d579efdf84696148e2c35ec9b5b37e">More...</a><br /></td></tr>
<tr class="separator:a41d579efdf84696148e2c35ec9b5b37e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff91b8ed07a19dbee7423270e89b7867"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#aff91b8ed07a19dbee7423270e89b7867">GdalLastErrorMsg</a><code> [get]</code></td></tr>
<tr class="memdesc:aff91b8ed07a19dbee7423270e89b7867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the last error message reported by GDAL library.  <a href="class_ogr_datasource.html#aff91b8ed07a19dbee7423270e89b7867">More...</a><br /></td></tr>
<tr class="separator:aff91b8ed07a19dbee7423270e89b7867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac08708b177feb37f8249e3cbcae88fb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interface_i_callback.html">ICallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ac08708b177feb37f8249e3cbcae88fb3">GlobalCallback</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ac08708b177feb37f8249e3cbcae88fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets or sets a Callback object which handles progress and error messages.  <a href="class_ogr_datasource.html#ac08708b177feb37f8249e3cbcae88fb3">More...</a><br /></td></tr>
<tr class="separator:ac08708b177feb37f8249e3cbcae88fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b7826c490fa49b896581cd6f64fddb"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#ab0b7826c490fa49b896581cd6f64fddb">Key</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ab0b7826c490fa49b896581cd6f64fddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets or sets a text string associated with object. Any value can be stored by developer in this property.  <a href="class_ogr_datasource.html#ab0b7826c490fa49b896581cd6f64fddb">More...</a><br /></td></tr>
<tr class="separator:ab0b7826c490fa49b896581cd6f64fddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7749e9129721f168f05728314d20af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#aae7749e9129721f168f05728314d20af">LastErrorCode</a><code> [get]</code></td></tr>
<tr class="memdesc:aae7749e9129721f168f05728314d20af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets code of the last error which took place inside this object.  <a href="class_ogr_datasource.html#aae7749e9129721f168f05728314d20af">More...</a><br /></td></tr>
<tr class="separator:aae7749e9129721f168f05728314d20af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59ab4b768bfe32fdcc93848a57231af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ogr_datasource.html#aa59ab4b768bfe32fdcc93848a57231af">LayerCount</a><code> [get]</code></td></tr>
<tr class="memdesc:aa59ab4b768bfe32fdcc93848a57231af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets number of layers in the datasource.  <a href="class_ogr_datasource.html#aa59ab4b768bfe32fdcc93848a57231af">More...</a><br /></td></tr>
<tr class="separator:aa59ab4b768bfe32fdcc93848a57231af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Represents GDAL/OGR vector datasource which may be represented by spatial database or file-based vector format. </p>
<p >The class can be used to access various vector datasources supported by GDAL/OGR. Depending on driver, datasources may be represented by particular file formats ( <a href="http://www.gdal.org/drv_shapefile.html">ESRI Shapefile</a>, <a href="http://www.gdal.org/drv_mitab.html">MapInfo TAB</a>, <a href="http://www.gdal.org/drv_kml.html">KML</a>, etc) or spatial databases (<a href="http://www.gdal.org/drv_pg.html">PostGIS</a>, <a href="http://www.gdal.org/drv_mssqlspatial.html">Microsoft SQL Server</a>, <a href="http://www.gdal.org/drv_sqlite.html">SpatiaLite</a>, etc). See the full list of formats in GDAL <a href="http://www.gdal.org/ogr_formats.html">documentation</a>.<br  />
<br  />
</p><div class="dotgraph">
<img src="dot_inline_dotgraph_51.png" alt="dot_inline_dotgraph_51.png" border="0" usemap="#dot_inline_dotgraph_51.map"/>
</div>
<p >OgrDatasource can be used for such tasks as:</p><ul>
<li>checking connection for particular datasource (<a class="el" href="class_ogr_datasource.html#a5e2f3a9e4885b0d71978c70583a983d3" title="Opens particular type of datasource supported by GDAL/OGR.">OgrDatasource.Open</a>);</li>
<li>listing and opening layers of datasource (<a class="el" href="class_ogr_datasource.html#a7576dfcd2fb8d7d10d14315078a54d91" title="Gets a layer with specified index from datasource.">OgrDatasource.GetLayer</a>, <a class="el" href="class_ogr_datasource.html#aa59ab4b768bfe32fdcc93848a57231af" title="Gets number of layers in the datasource.">OgrDatasource.LayerCount</a>, <a class="el" href="class_ogr_datasource.html#a46225206838093c69540668abc28887c" title="Gets a layer with specified name from the datasource.">OgrDatasource.GetLayerByName</a>);</li>
<li>creation of new layers via shapefile import (<a class="el" href="class_ogr_datasource.html#ad426ef7c2279788992fd883442f6b503" title="Creates a new layer in the datasource and populates it with data from specified shapefile.">OgrDatasource.ImportShapefile</a>);</li>
<li>running SQL queries against the datasource to retrieve or modify the data (<a class="el" href="class_ogr_datasource.html#a035e078df8e7feebe2e23ba1860b8643" title="Runs a query against datasource and returns the result as a temporary layer.">OgrDatasource.RunQuery</a>, <a class="el" href="class_ogr_datasource.html#a5dbf9de82251c4a2a39cbe00f73c2cb9" title="Executes SQL statement against datasource.">OgrDatasource.ExecuteSQL</a>);</li>
<li>checking for capabilities supported by particular driver (<a class="el" href="class_ogr_datasource.html#a3c8e8aa8bdd0541fa476cf90f4d95305" title="Test whether driver of the currently opened datasource supports particular capability.">OgrDatasource.TestCapability</a>)</li>
</ul>
<p>An instance of OgrDatasource can't be added to the map directly, but instances of <a class="el" href="class_ogr_layer.html" title="Represents a single layer in GDAL/OGR datasource or result of SQL query against such datasource.">OgrLayer</a> class opened by its methods can.<br  />
<br  />
OgrDatasource encapsulates an instance of GDALDataset C++ class. Check its <a href="http://www.gdal.org/classGDALDataset.html">documentation</a> to better understand what's going on under the hood. <br  />
<br  />
Here is code sample which lists all layers available in PostGIS database. </p><div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> CONNECTION_STRING = <span class="stringliteral">&quot;PG:host=localhost dbname=london user=postgres password=1234&quot;</span>;</div>
<div class="line"> </div>
<div class="line">var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">{</div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> count = ds.LayerCount;</div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Number of layers: &quot;</span> + count);</div>
<div class="line"> </div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;List of layers by name:&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++)</div>
<div class="line">    {</div>
<div class="line">        var lyr = ds.GetLayer(i);</div>
<div class="line">        Debug.Print(<span class="stringliteral">&quot;Layer name: &quot;</span> + lyr.Name);</div>
<div class="line">        Debug.Print(<span class="stringliteral">&quot;Projection: &quot;</span> + lyr.GeoProjection.ExportToProj4());</div>
<div class="line">        Debug.Print(<span class="stringliteral">&quot;Shape type: &quot;</span> + lyr.ShapeType);</div>
<div class="line">        lyr.Close();</div>
<div class="line">    }</div>
<div class="line">    ds.Close();</div>
<div class="line">}</div>
<div class="ttc" id="aclass_ogr_datasource_html"><div class="ttname"><a href="class_ogr_datasource.html">OgrDatasource</a></div><div class="ttdoc">Represents GDAL/OGR vector datasource which may be represented by spatial database or file-based vect...</div><div class="ttdef"><b>Definition:</b> OgrDatasource.cs:116</div></div>
</div><!-- fragment --><p> See more samples in description of particular methods.<br  />
<br  />
 <b>String encoding.</b><br  />
 OgrDatasource and <a class="el" href="class_ogr_layer.html" title="Represents a single layer in GDAL/OGR datasource or result of SQL query against such datasource.">OgrLayer</a> classes by default use UTF-8 string encoding to interact with underlying drivers. This applies to connection strings, layer names, SQL queries and error messages. This behavior can be changed by setting <a class="el" href="class_global_settings.html#a8e43d0edbcc84438b0688149e69f0b3a" title="Gets or sets string encoding used to communicate with OGR drivers.">GlobalSettings.OgrStringEncoding</a> property. The new setting will be used immediately by all existing and new objects. See details about string encoding in the documentation of particular OGR driver.<br  />
<br  />
 Here is a diagram for the <a class="el" href="class_ogr_datasource.html" title="Represents GDAL/OGR vector datasource which may be represented by spatial database or file-based vect...">OgrDatasource</a> class. </p><div class="dotgraph">
<img src="dot_inline_dotgraph_53.png" alt="dot_inline_dotgraph_53.png" border="0" usemap="#dot_inline_dotgraph_53.map"/>
<map name="dot_inline_dotgraph_53.map" id="dot_inline_dotgraph_53.map"><area shape="rect" href="class_shapefile.html" title="In&#45;memory shapefile with data" alt="" coords="5,139,184,168"/>
<area shape="rect" href="class_ogr_datasource.html" title="OgrDatasource" alt="" coords="44,5,145,35"/>
<area shape="rect" href="class_ogr_layer.html" title="OgrLayer" alt="" coords="45,64,144,109"/>
<area shape="poly" href="class_ogr_datasource.html#a7576dfcd2fb8d7d10d14315078a54d91" title="OgrDatasource.GetLayer()" alt="" coords="97,35,97,64,92,64,92,35"/>
<area shape="rect" href="class_ogr_datasource.html#a7576dfcd2fb8d7d10d14315078a54d91" title=" &#160;&#160;n" alt="" coords="90,50,106,63"/>
<area shape="poly" href="class_ogr_layer.html#a1a2ffbbd78168673391a0b1db054ae43" title="OgrLayer.GetBuffer()" alt="" coords="97,110,97,138,92,138,92,110"/>
<area shape="rect" href="class_ogr_layer.html#a1a2ffbbd78168673391a0b1db054ae43" title=" &#160;&#160;1" alt="" coords="89,124,107,138"/>
</map>
</div>
<p> <a href="diagrams.html">Graph description</a> </p>
<dl class="newpage493"><dt><b><a class="el" href="newpage493.html#_newpage493000068">New API 4.9.3:</a></b></dt><dd>Added in version 4.9.3 </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a3e68dc609f730e39277b6b88b47f4a35" name="a3e68dc609f730e39277b6b88b47f4a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e68dc609f730e39277b6b88b47f4a35">&#9670;&nbsp;</a></span>Close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OgrDatasource.Close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes datasource and underlying connection. </p>
<p >This method should be called as soon as datasource is no longer needed.</p>

</div>
</div>
<a id="ab7bba28541e83f353dbadb932c45fd7f" name="ab7bba28541e83f353dbadb932c45fd7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7bba28541e83f353dbadb932c45fd7f">&#9670;&nbsp;</a></span>CreateLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.CreateLayer </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_enumerations_8cs.html#a96d6460f5cd3c49b4c12be5a38c82b4e">ShpfileType</a>&#160;</td>
          <td class="paramname"><em>ShpType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_geo_projection.html">GeoProjection</a>&#160;</td>
          <td class="paramname"><em>Projection</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>creationOptions</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new empty layer in the datasource. </p>
<p >SRID will be set to 0 if null or empty <a class="el" href="class_geo_projection.html" title="Holds information about coordinate system and projection of the data.">GeoProjection</a> object is passed. See <a class="el" href="class_ogr_datasource.html#ad426ef7c2279788992fd883442f6b503" title="Creates a new layer in the datasource and populates it with data from specified shapefile.">OgrDatasource.ImportShapefile</a> for the details on creation options.<br  />
 Known issues: creation of layer in nonexistent schema in PostGIS databases completes successfully, yet the neither schema nor objects in it are visible afterwards. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layerName</td><td>Name of the new layer.</td></tr>
    <tr><td class="paramname">ShpType</td><td>ShpType of the new layer. Will be converted to appropriate OGRwkbGeometryType.</td></tr>
    <tr><td class="paramname">Projection</td><td>GeoProjection object which sets SRID of the new layer.</td></tr>
    <tr><td class="paramname">creationOptions</td><td>Format specific creation options separated with semicolon, e.g. "OVERWRITE=YES;MW_MULTI_PART=no". </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success.</dd></dl>

</div>
</div>
<a id="a83b5c311a096f0631fef35bde93458cb" name="a83b5c311a096f0631fef35bde93458cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83b5c311a096f0631fef35bde93458cb">&#9670;&nbsp;</a></span>DeleteLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.DeleteLayer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layerIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a layer with specified index from datasource. </p>
<p >Use <a class="el" href="class_ogr_datasource.html#a3c8e8aa8bdd0541fa476cf90f4d95305" title="Test whether driver of the currently opened datasource supports particular capability.">OgrDatasource.TestCapability</a>(<a class="el" href="_enumerations_8cs.html#a710e0875fd39fa0757cfcbfdacf00052a8dbf89972ab7ae8bb7bc50219705b9e7">tkOgrDSCapability.odcDeleteLayer</a>) to check whether functionality is supported by particular driver.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layerIndex</td><td>Layer index within datasource.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success.</dd></dl>

</div>
</div>
<a id="a5dbf9de82251c4a2a39cbe00f73c2cb9" name="a5dbf9de82251c4a2a39cbe00f73c2cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dbf9de82251c4a2a39cbe00f73c2cb9">&#9670;&nbsp;</a></span>ExecuteSQL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.ExecuteSQL </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>sql</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">out string&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes SQL statement against datasource. </p>
<p >Should be used for non-SELECT instructions which don't return resulting set of rows. To select data use <a class="el" href="class_ogr_datasource.html#a035e078df8e7feebe2e23ba1860b8643" title="Runs a query against datasource and returns the result as a temporary layer.">OgrDatasource.RunQuery</a> instead. </p>
<p ><br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sql</td><td>SQL instruction.</td></tr>
    <tr><td class="paramname">errorMessage</td><td>Error message provided in case of failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success and false otherwise.</dd></dl>
<p>The following code deletes records from underlying database table with gid &gt; 100. </p><div class="fragment"><div class="line">var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">{</div>
<div class="line">    Debug.Pring(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">string</span> errorMsg;</div>
<div class="line">    <span class="keywordtype">bool</span> result = ds.ExecuteSQL(<span class="stringliteral">&quot;DELETE FROM tableName WHERE gid &gt; 100&quot;</span>, out errorMsg);</div>
<div class="line">    <span class="keywordflow">if</span> (!result)</div>
<div class="line">    {</div>
<div class="line">        Debug.Pring(<span class="stringliteral">&quot;Error on running SQL: &quot;</span> + errorMsg);    </div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        Debug.Pring(<span class="stringliteral">&quot;SQL was executed successfully.&quot;</span>);    </div>
<div class="line">    }</div>
<div class="line">    ds.Close();</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a0e221d078d66e3f7333ee25418133ef5" name="a0e221d078d66e3f7333ee25418133ef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e221d078d66e3f7333ee25418133ef5">&#9670;&nbsp;</a></span>get_DriverMetadata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.get_DriverMetadata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694">tkGdalDriverMetadata</a>&#160;</td>
          <td class="paramname"><em>metadata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns certain type of metadata associated with current driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metadata</td><td>Type of metadata to be returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Metadata or empty string if requested type of metadata isn't set for the driver.</dd></dl>
<div class="fragment"><div class="line">var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">{</div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// first display couple of specific items</span></div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Layer creation options: &quot;</span> + ds.get_DriverMetadata(<a class="code hl_enumeration" href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694">tkGdalDriverMetadata</a>.dmdLAYER_CREATIONOPTIONLIST));</div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Long name: &quot;</span> + ds.get_DriverMetadata(<a class="code hl_enumeration" href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694">tkGdalDriverMetadata</a>.dmdLONGNAME));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// now display all the available items</span></div>
<div class="line">    Debug.Print(<span class="stringliteral">&quot;Metadata items: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ds.DriverMetadataCount; i++)</div>
<div class="line">    {</div>
<div class="line">        Debug.Print(ds.get_DriverMetadataItem(i));</div>
<div class="line">    }</div>
<div class="line">    ds.Close();</div>
<div class="line">}</div>
<div class="ttc" id="a_enumerations_8cs_html_ad777ab4ec9dd9ba542ee19ef486a8694"><div class="ttname"><a href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694">tkGdalDriverMetadata</a></div><div class="ttdeci">tkGdalDriverMetadata</div><div class="ttdoc">Possible metadata items which can be associated with particular GDAL driver.</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:2294</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a1aba366ca5d8761ec01ea74782ae132c" name="a1aba366ca5d8761ec01ea74782ae132c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aba366ca5d8761ec01ea74782ae132c">&#9670;&nbsp;</a></span>get_DriverMetadataItem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.get_DriverMetadataItem </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>metadataIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets metadata item with specified index associated with current driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metadataIndex</td><td>Index of metadata item to be returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String with metadata.</dd></dl>

</div>
</div>
<a id="a73d1066651fd9d05de6a6fdc761a2195" name="a73d1066651fd9d05de6a6fdc761a2195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d1066651fd9d05de6a6fdc761a2195">&#9670;&nbsp;</a></span>get_ErrorMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.get_ErrorMsg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ErrorCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the description of the specific error code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ErrorCode</td><td>The error code returned by LastErrorCode property.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String with the description.</dd></dl>

</div>
</div>
<a id="a7576dfcd2fb8d7d10d14315078a54d91" name="a7576dfcd2fb8d7d10d14315078a54d91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7576dfcd2fb8d7d10d14315078a54d91">&#9670;&nbsp;</a></span>GetLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ogr_layer.html">OgrLayer</a> OgrDatasource.GetLayer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forUpdate</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a layer with specified index from datasource. </p>
<p >Resulting <a class="el" href="class_ogr_layer.html" title="Represents a single layer in GDAL/OGR datasource or result of SQL query against such datasource.">OgrLayer</a> has no reference to OgrDatasource object, which can safely closed if it is no longer needed.<br  />
<br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Index</td><td>Index of layer to be returned.</td></tr>
    <tr><td class="paramname">forUpdate</td><td>Indicates whether the returned layer will support saving of changes back to source (the functionality should be supported by particular driver).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Instance of <a class="el" href="class_ogr_layer.html" title="Represents a single layer in GDAL/OGR datasource or result of SQL query against such datasource.">OgrLayer</a> or null on failure.</dd></dl>
<p>The following code adds all layers found in the datasource to the map: </p><div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> CONNECTION_STRING = <span class="stringliteral">&quot;PG:host=localhost dbname=london user=postgres password=1234&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> DisplayAllLayers()</div>
<div class="line">{</div>
<div class="line">    var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">    {</div>
<div class="line">        Debug.WriteLine(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        map.RemoveAllLayers();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// make sure it matches SRID of the layers (4326 in our case)</span></div>
<div class="line">        map.Projection = <a class="code hl_enumeration" href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a>.PROJECTION_WGS84;   </div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ds.LayerCount; i++)</div>
<div class="line">        {</div>
<div class="line">            var layer = ds.GetLayer(i);</div>
<div class="line">            <span class="keywordflow">if</span> (layer != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">int</span> handle = map.AddLayer(layer, <span class="keyword">true</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (handle == -1)</div>
<div class="line">                {</div>
<div class="line">                    Debug.WriteLine(<span class="stringliteral">&quot;Failed to add layer to the map: &quot;</span> + map.get_ErrorMsg(map.LastErrorCode));</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    Debug.WriteLine(<span class="stringliteral">&quot;Layer was added the map: &quot;</span> + layer.Name);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        map.ZoomToMaxVisibleExtents();</div>
<div class="line">        ds.Close();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="a_enumerations_8cs_html_ad7975e2723bbf83d20e1820bb0020dd7"><div class="ttname"><a href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a></div><div class="ttdeci">tkMapProjection</div><div class="ttdoc">Commonly used map projections to be set in Form Designer (see AxMap.Projection property).</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:1741</div></div>
</div><!-- fragment --><p> See more details on projection &amp; coordinates strategies in <a href="group__map__coordinates.html#details">Map projection and coordinates</a> section. </p>

</div>
</div>
<a id="a8f60736d0c98e3f1a042d72eba210993" name="a8f60736d0c98e3f1a042d72eba210993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f60736d0c98e3f1a042d72eba210993">&#9670;&nbsp;</a></span>GetLayer2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ogr_layer.html">OgrLayer</a> OgrDatasource.GetLayer2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forUpdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>newConnection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a46225206838093c69540668abc28887c" name="a46225206838093c69540668abc28887c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46225206838093c69540668abc28887c">&#9670;&nbsp;</a></span>GetLayerByName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ogr_layer.html">OgrLayer</a> OgrDatasource.GetLayerByName </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forUpdate</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a layer with specified name from the datasource. </p>
<p >In case of spatial databases layerName corresponds to name of the underlying table. However there can be some format specifics. For example name may include schema prefix and name of geometry column (in case there is more than one geometry column in the table). For example, <em>"public.buildings(geom2)"</em> may correspond to <em>"geom2"</em> column of table named <em>"buildings"</em> in <em>"public"</em> schema.<br  />
 Resulting layer has no reference to OgrDatasource object, which can safely closed if it is no longer needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layerName</td><td>Layer name (case insensitive).</td></tr>
    <tr><td class="paramname">forUpdate</td><td>Indicates whether the returned layer will support saving of changes back to source (the functionality should be supported by particular driver).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Instance of <a class="el" href="class_ogr_layer.html" title="Represents a single layer in GDAL/OGR datasource or result of SQL query against such datasource.">OgrLayer</a> or null on failure.</dd></dl>

</div>
</div>
<a id="a23bcdd5d570729953e616ec77488a73e" name="a23bcdd5d570729953e616ec77488a73e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23bcdd5d570729953e616ec77488a73e">&#9670;&nbsp;</a></span>GetLayerName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.GetLayerName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layerIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a name of the layer with particular index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layerIndex</td><td>Index of layer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of layer or empty string for invalid layer index.</dd></dl>

</div>
</div>
<a id="ae7073ca1e7d63784e3289776fad6a974" name="ae7073ca1e7d63784e3289776fad6a974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7073ca1e7d63784e3289776fad6a974">&#9670;&nbsp;</a></span>GetSchemas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">object OgrDatasource.GetSchemas </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the array with schema names in the datasources. </p>
<dl class="section return"><dt>Returns</dt><dd>Boxed string array.</dd></dl>
<dl class="newpage494"><dt><b><a class="el" href="newpage494.html#_newpage494000069">New API 4.9.4:</a></b></dt><dd>Added in version 4.9.4 </dd></dl>

</div>
</div>
<a id="ad426ef7c2279788992fd883442f6b503" name="ad426ef7c2279788992fd883442f6b503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad426ef7c2279788992fd883442f6b503">&#9670;&nbsp;</a></span>ImportShapefile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.ImportShapefile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_shapefile.html">Shapefile</a>&#160;</td>
          <td class="paramname"><em>shapefile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>creationOptions</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0">tkShapeValidationMode</a>&#160;</td>
          <td class="paramname"><em>validationMode</em> = <code><a class="el" href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0a45c5efbe1799d1704a3274f40d6a6ed5">tkShapeValidationMode.TryFixSkipOnFailure</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new layer in the datasource and populates it with data from specified shapefile. </p>
<p >The list of available creation options can be found in GDAL on-line <a href="http://www.gdal.org/ogr_formats.html">documentation</a> or retrieved by calling <a class="el" href="class_ogr_datasource.html#a0e221d078d66e3f7333ee25418133ef5" title="Returns certain type of metadata associated with current driver.">OgrDatasource.get_DriverMetadata</a>(<a class="el" href="_enumerations_8cs.html#ad777ab4ec9dd9ba542ee19ef486a8694a1b8ba4da8452e697f9fad22013a2c169">tkGdalDriverMetadata.dmdLAYER_CREATIONOPTIONLIST</a>). <br  />
<br  />
In addition MapWinGIS defines its own options:</p><ul>
<li>MW_MULTI_PART={YES, NO} - sets whether single part or multipart geometry type column will be created to store data. The default value is "YES", i.e. MultiLineString will be used for polylines and MultiPolygon for polygons. "NO" option will result in LineString and Polygon types respectively, which won't allow multi-part polylines or polygons with multiple outer rings.</li>
<li>MW_POSTGIS_VACUUM={YES, NO} - indicates whether a VACUUM operation should be called after importing a layer into PostGIS database. The default value is "YES".<br  />
 Depending on driver invalid geometries may be accepted in the datasource, but they may cause errors on trying to perform spatial queries against these layers later on.<br  />
 Results of validation may be accessed via <a class="el" href="group__shapefile__validation.html#gad33abad25f34898955228427b7a2c022" title="Gets results of input data validation for geoprocessing methods.">Shapefile.LastInputValidation</a> of shapefile parameter. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shapefile</td><td>Shapefile to import.</td></tr>
    <tr><td class="paramname">layerName</td><td>Name for the imported layer.</td></tr>
    <tr><td class="paramname">creationOptions</td><td>Format specific creation options separated with semicolon, e.g. <em>"OVERWRITE=YES;MW_MULTI_PART=no"</em>. </td></tr>
    <tr><td class="paramname">validationMode</td><td>Sets validation mode for input shapes, ranging from no validation to abort the whole operation on the first invalid shape.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success.</dd></dl>
<p>The following code imports all shapefiles from the specified folder as layers into the datasource. </p><div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> CONNECTION_STRING = <span class="stringliteral">&quot;PG:host=localhost dbname=london user=postgres password=1234&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> ImportShapefileFromFolder()</div>
<div class="line">{</div>
<div class="line">    var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">    {</div>
<div class="line">        Debug.Pring(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">string</span> path = <span class="stringliteral">@&quot;d:\data\sf\london&quot;</span>;</div>
<div class="line">        var files = Directory.GetFiles(path, <span class="stringliteral">&quot;*.shp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">foreach</span> (var file <span class="keywordflow">in</span> files)</div>
<div class="line">        {</div>
<div class="line">            var sf = <span class="keyword">new</span> <a class="code hl_class" href="class_shapefile.html">Shapefile</a>();</div>
<div class="line">            <span class="keywordflow">if</span> (!sf.Open(file))</div>
<div class="line">            {</div>
<div class="line">                Debug.Print(<span class="stringliteral">&quot;Failed to open shapefile: {0}\n{1}&quot;</span>, file, sf.get_ErrorMsg(sf.LastErrorCode));</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">string</span> name = Path.GetFileNameWithoutExtension(file);</div>
<div class="line">                <span class="keywordflow">if</span> (!ds.ImportShapefile(sf, name, <span class="stringliteral">&quot;OVERWRITE=YES&quot;</span>, <a class="code hl_enumeration" href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0">tkShapeValidationMode</a>.NoValidation))</div>
<div class="line">                {</div>
<div class="line">                    Debug.Print(<span class="stringliteral">&quot;Failed to import shapefile: &quot;</span> + name);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    Debug.Print(<span class="stringliteral">&quot;Layer was imported: &quot;</span> + name);</div>
<div class="line">                    var layer = ds.GetLayerByName(name);</div>
<div class="line">                    <span class="keywordflow">if</span> (layer != <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        Debug.Print(<span class="stringliteral">&quot;Imported features count: &quot;</span> + layer.FeatureCount);</div>
<div class="line">                        layer.Close();</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        ds.Close();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="a_enumerations_8cs_html_a51f0a49aa49bc97b266864767dff87c0"><div class="ttname"><a href="_enumerations_8cs.html#a51f0a49aa49bc97b266864767dff87c0">tkShapeValidationMode</a></div><div class="ttdeci">tkShapeValidationMode</div><div class="ttdoc">Possible validation modes for shapefiles.</div><div class="ttdef"><b>Definition:</b> Enumerations.cs:1921</div></div>
<div class="ttc" id="aclass_shapefile_html"><div class="ttname"><a href="class_shapefile.html">Shapefile</a></div><div class="ttdoc">Provides a functionality for accessing and editing ESRI shapefiles.</div><div class="ttdef"><b>Definition:</b> Shapefile.cs:72</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="af0ada026c12369518aa4616e448e8386" name="af0ada026c12369518aa4616e448e8386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0ada026c12369518aa4616e448e8386">&#9670;&nbsp;</a></span>LayerIndexByName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OgrDatasource.LayerIndexByName </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>layerName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns index of layer with the specified name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layerName</td><td>Layer name (case insensitive).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of layer or -1 in case it wasn't found.</dd></dl>

</div>
</div>
<a id="a5e2f3a9e4885b0d71978c70583a983d3" name="a5e2f3a9e4885b0d71978c70583a983d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e2f3a9e4885b0d71978c70583a983d3">&#9670;&nbsp;</a></span>Open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.Open </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionString</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens particular type of datasource supported by GDAL/OGR. </p>
<p >See details about connection strings here: <a href="http://www.gdal.org/ogr_formats.html">http://www.gdal.org/ogr_formats.html</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionString</td><td>Connection string for RDMSs or filename for file-based formats.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success.</dd></dl>

</div>
</div>
<a id="ab60fff3aaa784fb1e552bbe0cc36a47c" name="ab60fff3aaa784fb1e552bbe0cc36a47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab60fff3aaa784fb1e552bbe0cc36a47c">&#9670;&nbsp;</a></span>Open2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.Open2 </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionString</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forUpdate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens particular type of datasource supported by GDAL/OGR. </p>
<p >See details about connection strings here: <a href="http://www.gdal.org/ogr_formats.html">http://www.gdal.org/ogr_formats.html</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionString</td><td>Connection string for RDMSs or filename for file-based formats.</td></tr>
    <tr><td class="paramname">forUpdate</td><td>Indicates whether datasource will be opened with update flag.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success.</dd></dl>

</div>
</div>
<a id="a035e078df8e7feebe2e23ba1860b8643" name="a035e078df8e7feebe2e23ba1860b8643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a035e078df8e7feebe2e23ba1860b8643">&#9670;&nbsp;</a></span>RunQuery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_ogr_layer.html">OgrLayer</a> OgrDatasource.RunQuery </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>sql</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs a query against datasource and returns the result as a temporary layer. </p>
<p >Usually some sort of SELECT query returning a set of rows with one or several geometry columns is expected here. Other types of SQL instructions will also be processed, however <a class="el" href="class_ogr_datasource.html#a5dbf9de82251c4a2a39cbe00f73c2cb9" title="Executes SQL statement against datasource.">OgrDatasource.ExecuteSQL</a> is recommended way to do it.<br  />
<br  />
Resulting layer has no reference to OgrDatasource object, which can safely closed if it is no longer needed.<br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sql</td><td>SQL query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Temporary layer or null on failure.</dd></dl>
<p>The following code builds 0.01 degree buffer zones around waterways layer extracted from database and displays both waterways and buffer layers on the map. st_buffer function is supported by PostGIS. See documentation of particular spatial database for list of supported functions and their arguments. </p><div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> CONNECTION_STRING = <span class="stringliteral">&quot;PG:host=localhost dbname=london user=postgres password=1234&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> TestSpatialQuery()</div>
<div class="line">{</div>
<div class="line">    var ds = <span class="keyword">new</span> <a class="code hl_class" href="class_ogr_datasource.html">OgrDatasource</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!ds.Open(CONNECTION_STRING))</div>
<div class="line">    {</div>
<div class="line">        Debug.WriteLine(<span class="stringliteral">&quot;Failed to establish connection: &quot;</span> + ds.GdalLastErrorMsg);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        map.RemoveAllLayers();</div>
<div class="line">        map.Projection = <a class="code hl_enumeration" href="_enumerations_8cs.html#ad7975e2723bbf83d20e1820bb0020dd7">tkMapProjection</a>.PROJECTION_WGS84;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// build a buffer in a first query</span></div>
<div class="line">        <span class="keywordtype">string</span> sql = <span class="stringliteral">&quot;SELECT st_buffer(wkb_geometry, 0.01) AS buffer, * FROM waterways;&quot;</span>;</div>
<div class="line">        var buffer = ds.RunQuery(sql);</div>
<div class="line">        <span class="keywordflow">if</span> (buffer == <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            Debug.WriteLine(<span class="stringliteral">&quot;Failed to build buffer: &quot;</span> + gs.GdalLastErrorMsg);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            Debug.WriteLine(<span class="stringliteral">&quot;Number of features in a buffer: &quot;</span> + buffer.FeatureCount);</div>
<div class="line">            map.AddLayer(buffer, <span class="keyword">true</span>);</div>
<div class="line">            buffer.GetBuffer().DefaultDrawingOptions.FillColor = 255;     <span class="comment">// red</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// simply extract unaltered source features in the second query and display them above the buffer</span></div>
<div class="line">        <span class="keywordtype">string</span> sql2 = <span class="stringliteral">&quot;SELECT * FROM waterways;&quot;</span>;</div>
<div class="line">        var layer = ds.RunQuery(sql2);</div>
<div class="line">        <span class="keywordflow">if</span> (layer == <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            Debug.WriteLine(<span class="stringliteral">&quot;Failed to open layer: &quot;</span> + gs.GdalLastErrorMsg);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            Debug.WriteLine(<span class="stringliteral">&quot;Number of features in layer: &quot;</span> + layer.FeatureCount);</div>
<div class="line">            map.AddLayer(layer, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line">        ds.Close();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a3c8e8aa8bdd0541fa476cf90f4d95305" name="a3c8e8aa8bdd0541fa476cf90f4d95305"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c8e8aa8bdd0541fa476cf90f4d95305">&#9670;&nbsp;</a></span>TestCapability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OgrDatasource.TestCapability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_enumerations_8cs.html#a710e0875fd39fa0757cfcbfdacf00052">tkOgrDSCapability</a>&#160;</td>
          <td class="paramname"><em>capability</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether driver of the currently opened datasource supports particular capability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">capability</td><td>A capability to test.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True in case the capability is supported by the driver.</dd></dl>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="a6b84377fed7f463443a52f10627da000" name="a6b84377fed7f463443a52f10627da000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b84377fed7f463443a52f10627da000">&#9670;&nbsp;</a></span>DriverMetadataCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OgrDatasource.DriverMetadataCount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the number of metadata items associated with current driver. </p>

</div>
</div>
<a id="a41d579efdf84696148e2c35ec9b5b37e" name="a41d579efdf84696148e2c35ec9b5b37e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41d579efdf84696148e2c35ec9b5b37e">&#9670;&nbsp;</a></span>DriverName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.DriverName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets name driver (name of format) for this datasource. </p>

</div>
</div>
<a id="aff91b8ed07a19dbee7423270e89b7867" name="aff91b8ed07a19dbee7423270e89b7867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff91b8ed07a19dbee7423270e89b7867">&#9670;&nbsp;</a></span>GdalLastErrorMsg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.GdalLastErrorMsg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extracts the last error message reported by GDAL library. </p>

</div>
</div>
<a id="ac08708b177feb37f8249e3cbcae88fb3" name="ac08708b177feb37f8249e3cbcae88fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac08708b177feb37f8249e3cbcae88fb3">&#9670;&nbsp;</a></span>GlobalCallback</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interface_i_callback.html">ICallback</a> OgrDatasource.GlobalCallback</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets or sets a Callback object which handles progress and error messages. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000120">Deprecated:</a></b></dt><dd>v4.9.3 Use <a class="el" href="class_global_settings.html#ac01309d06b2dc9c11019a8c8589da3c8" title="Gets or sets global callback object to report information about progress and errors taking place insi...">GlobalSettings.ApplicationCallback</a> instead. </dd></dl>

</div>
</div>
<a id="ab0b7826c490fa49b896581cd6f64fddb" name="ab0b7826c490fa49b896581cd6f64fddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b7826c490fa49b896581cd6f64fddb">&#9670;&nbsp;</a></span>Key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string OgrDatasource.Key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets or sets a text string associated with object. Any value can be stored by developer in this property. </p>

</div>
</div>
<a id="aae7749e9129721f168f05728314d20af" name="aae7749e9129721f168f05728314d20af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7749e9129721f168f05728314d20af">&#9670;&nbsp;</a></span>LastErrorCode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OgrDatasource.LastErrorCode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets code of the last error which took place inside this object. </p>

</div>
</div>
<a id="aa59ab4b768bfe32fdcc93848a57231af" name="aa59ab4b768bfe32fdcc93848a57231af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa59ab4b768bfe32fdcc93848a57231af">&#9670;&nbsp;</a></span>LayerCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OgrDatasource.LayerCount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets number of layers in the datasource. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_ogr_datasource.html">OgrDatasource</a></li>
    <li class="footer">Generated on Tue Mar 15 2022 17:12:12 for MapWinGIS by 
		<a href="https://www.doxygen.org/index.html">
			<img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/>
		</a> 1.9.3 
	</li>
  </ul>
</div>
<footer>
<!-- ---------------------------------------------------------------------------- 
 Place the following near the bottom of the body of the html content to load the 
 script and execute the ad load method. 
 Only place ONE copy at the bottom of the file, NOT one for each tag.  The script 
 finds all the tags and then make the requests to the Ad Server for each of them.
-----------------------------------------------------------------------------  -->
<script type='text/javascript'>
    function _dmBootstrap(file) { 
        var _dma = document.createElement('script');  
        _dma.type = 'text/javascript'; 
        _dma.async = true;  
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file; 
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined')  _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000);})();
</script> 
</footer>
</body>
</html>
